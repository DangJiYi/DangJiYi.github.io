<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通达信、同花顺涨跌停代码 - --</title>
    <meta name="description" content="">
    <meta name="keywords" content="编程, 技术博客, Python">
    
    <!-- 新增：添加网页标签图标（favicon） -->
    <link rel="icon" href="static/images/avatar.png" type="image/png">
    <link rel="shortcut icon" href="static/images/avatar.png" type="image/png">

    <!-- Open Graph -->
    <meta property="og:title" content="通达信、同花顺涨跌停代码 - --">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    
    <!-- CSS -->
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/prism.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="https://eee.dangjiyi.eu.org/" class="brand-link">
                    <i class="fas fa-robot"></i>
                    <span>静态博客站</span>
                </a>
            </div>
            <div class="nav-menu">
                <a href="https://eee.dangjiyi.eu.org/" class="nav-link">首页</a>
            </div>
        </div>
    </nav>

    <!-- 主要内容 -->
    <main class="main-content">
        
<article class="post-container">
    <!-- 文章头部 -->
    <header class="post-header">
        <h1 class="post-title">通达信、同花顺涨跌停代码</h1>
        <div class="post-meta">
            <time class="post-date">
                <i class="far fa-calendar"></i>
                2025-09-15
            </time>
            <span class="post-author">
                <i class="far fa-user"></i>
                  
            </span>
            
            <div class="post-tags">
                
                <span class="tag">炒股</span>
                
                <span class="tag">代码</span>
                
            </div>
            
        </div>
    </header>

    <!-- 文章内容 -->
    <div class="post-content">
        <h1 id="_1">通达信分时代码</h1>
<div class="img-zoom-container"><img src="images/Snipaste_2025-09-14_21-46-59.png" alt="" class="zoomable-img" title="点击放大图片"></div>

<div class="codehilite"><pre><span></span><code><span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">01</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;概念：&#39;</span><span class="o">,</span><span class="w"> </span><span class="nt">GNBLOCK</span><span class="o">)),</span><span class="w"> </span><span class="nt">COLORCYAN</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">01</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">9</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT6</span><span class="o">(</span><span class="s1">&#39;行业：&#39;</span><span class="o">,</span><span class="nt">HYBLOCK</span><span class="o">,</span><span class="s1">&#39;_&#39;</span><span class="o">,</span><span class="nt">MOREHYBLOCK</span><span class="o">,</span><span class="s1">&#39;_&#39;</span><span class="o">,</span><span class="nt">DYBLOCK</span><span class="o">)),</span><span class="w"> </span><span class="nt">COLORMAGENTA</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>



<span class="p">{</span><span class="w"> </span><span class="err">代码功能：主图动态显示全市场涨跌家数及停板家数</span><span class="w"> </span><span class="p">}</span>


<span class="p">{</span><span class="err">计算上涨总家数和下跌总家数</span><span class="p">}</span>

<span class="nt">上涨总家数</span><span class="p">:</span><span class="nd">MAINZSHQ</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">6</span><span class="o">)+</span><span class="nt">MAINZSHQ</span><span class="o">(</span><span class="nt">2</span><span class="o">,</span><span class="nt">6</span><span class="o">),</span><span class="nt">NODRAW</span><span class="o">;</span>
<span class="nt">下跌总家数</span><span class="p">:</span><span class="nd">MAINZSHQ</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">7</span><span class="o">)+</span><span class="nt">MAINZSHQ</span><span class="o">(</span><span class="nt">2</span><span class="o">,</span><span class="nt">7</span><span class="o">),</span><span class="nt">NODRAW</span><span class="o">;</span>


<span class="p">{</span><span class="err">上涨总家数:TOTALHQINFO(1),</span><span class="w"> </span><span class="err">NODRAW</span><span class="p">;</span>
<span class="err">下跌总家数:TOTALHQINFO(2),</span><span class="w"> </span><span class="err">NODRAW</span><span class="p">;}</span>
<span class="nt">涨停数</span><span class="p">:</span><span class="nd">TOTALHQINFO</span><span class="o">(</span><span class="nt">3</span><span class="o">),</span><span class="w"> </span><span class="nt">NODRAW</span><span class="o">;</span>
<span class="nt">跌停数</span><span class="p">:</span><span class="nd">TOTALHQINFO</span><span class="o">(</span><span class="nt">4</span><span class="o">),</span><span class="w"> </span><span class="nt">NODRAW</span><span class="o">;</span>

<span class="p">{</span><span class="err">显示流通市值</span><span class="p">}</span>
<span class="nt">流通市值</span><span class="p">:</span><span class="nd">FINANCE</span><span class="o">(</span><span class="nt">46</span><span class="o">)*</span><span class="nt">DYNAINFO</span><span class="o">(</span><span class="nt">7</span><span class="o">)/</span><span class="nt">100000000</span><span class="o">,</span><span class="w"> </span><span class="nt">NODRAW</span><span class="o">;</span>

<span class="p">{</span><span class="err">计算主力净额</span><span class="p">}</span>
<span class="nt">超B</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>
<span class="nt">大B</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>

<span class="nt">超S</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">1</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>
<span class="nt">大S</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">1</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>

<span class="p">{</span><span class="err">主力净额:((超B+大B)-(超S+大S))/10000,NODRAW</span><span class="p">;}</span>
<span class="nt">主力净额</span><span class="p">:</span><span class="nd">DYNAINFO</span><span class="o">(</span><span class="nt">100</span><span class="o">)/</span><span class="nt">100000000</span><span class="o">,</span><span class="nt">NODRAW</span><span class="o">;</span>


<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">37</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">7</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;流通市值(亿):&#39;</span><span class="o">,</span><span class="w"> </span><span class="nt">CON2STR</span><span class="o">(</span><span class="nt">流通市值</span><span class="o">,</span><span class="nt">2</span><span class="o">)</span><span class="w"> </span><span class="o">)),</span><span class="w"> </span><span class="nt">COLORFFFF80</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>

<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">01</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">6</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;上涨：&#39;</span><span class="o">,</span><span class="w"> </span><span class="nt">CON2STR</span><span class="o">(</span><span class="nt">上涨总家数</span><span class="o">,</span><span class="nt">0</span><span class="o">)</span><span class="w"> </span><span class="o">)),</span><span class="w"> </span><span class="nt">COLORRED</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span><span class="w">   </span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">19</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">6</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;下跌：&#39;</span><span class="o">,</span><span class="w"> </span><span class="nt">CON2STR</span><span class="o">(</span><span class="nt">下跌总家数</span><span class="o">,</span><span class="nt">0</span><span class="o">)</span><span class="w"> </span><span class="o">)),</span><span class="w"> </span><span class="nt">COLORGREEN</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>

<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">01</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">7</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;涨停：&#39;</span><span class="o">,</span><span class="nt">CON2STR</span><span class="o">(</span><span class="nt">涨停数</span><span class="o">,</span><span class="nt">0</span><span class="o">))),</span><span class="w"> </span><span class="nt">COLORLIRED</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">19</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">7</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;跌停：&#39;</span><span class="o">,</span><span class="nt">CON2STR</span><span class="o">(</span><span class="nt">跌停数</span><span class="o">,</span><span class="nt">0</span><span class="o">))),</span><span class="w"> </span><span class="nt">COLORLIGREEN</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>

<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">37</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="p">.</span><span class="nc">6</span><span class="o">,</span><span class="w"> </span><span class="nt">0</span><span class="o">,</span><span class="w"> </span><span class="nt">STRCAT</span><span class="o">(</span><span class="s1">&#39;主力净额(亿):&#39;</span><span class="o">,</span><span class="w"> </span><span class="nt">CON2STR</span><span class="o">(</span><span class="nt">主力净额</span><span class="o">,</span><span class="nt">4</span><span class="o">)</span><span class="w"> </span><span class="o">)),</span><span class="w"> </span><span class="nt">COLORFF00FF</span><span class="o">;</span><span class="p">{</span><span class="err">右，下，左</span><span class="p">}</span><span class="o">;</span>
</code></pre></div>

<h1 id="k">通达信k线代码（均线修改版）</h1>
<div class="img-zoom-container"><img src="images/2.png" alt="" class="zoomable-img" title="点击放大图片"></div>

<div class="codehilite"><pre><span></span><code><span class="n">MA5</span><span class="o">:</span><span class="n">MA</span><span class="o">(</span><span class="n">CLOSE</span><span class="o">,</span><span class="n">M1</span><span class="o">);</span>
<span class="n">MA20</span><span class="o">:</span><span class="n">MA</span><span class="o">(</span><span class="n">CLOSE</span><span class="o">,</span><span class="n">M2</span><span class="o">);</span>
<span class="n">MA60</span><span class="o">:</span><span class="n">MA</span><span class="o">(</span><span class="n">CLOSE</span><span class="o">,</span><span class="n">M3</span><span class="o">);</span>
<span class="n">MA100</span><span class="o">:</span><span class="n">MA</span><span class="o">(</span><span class="n">CLOSE</span><span class="o">,</span><span class="n">M4</span><span class="o">);</span>


<span class="n">DRAWTEXT_FIX</span><span class="o">(</span><span class="n">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="mf">0.01</span><span class="o">,</span><span class="w"> </span><span class="mf">0.05</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="n">STRCAT</span><span class="o">(</span><span class="s1">&#39;概念：&#39;</span><span class="o">,</span><span class="n">GNBLOCK</span><span class="w"> </span><span class="o">)),</span><span class="w"> </span><span class="n">COLORCYAN</span><span class="o">;{</span><span class="err">右，下，左</span><span class="o">};</span>
<span class="n">DRAWTEXT_FIX</span><span class="o">(</span><span class="n">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="mf">0.01</span><span class="o">,</span><span class="w"> </span><span class="mf">0.15</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="n">STRCAT6</span><span class="o">(</span><span class="s1">&#39;行业：&#39;</span><span class="o">,</span><span class="n">HYBLOCK</span><span class="o">,</span><span class="s1">&#39;_&#39;</span><span class="o">,</span><span class="n">MOREHYBLOCK</span><span class="o">,</span><span class="s1">&#39;_&#39;</span><span class="o">,</span><span class="n">DYBLOCK</span><span class="o">)),</span><span class="w"> </span><span class="n">COLORMAGENTA</span><span class="o">;{</span><span class="err">右，下，左</span><span class="o">};</span>

<span class="o">{</span><span class="err">显示流通市值</span><span class="o">}</span><span class="w">   </span>
<span class="err">流通市值</span><span class="o">:</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">46</span><span class="o">)*</span><span class="n">DYNAINFO</span><span class="o">(</span><span class="mi">7</span><span class="o">)/</span><span class="mi">100000000</span><span class="o">,</span><span class="w"> </span><span class="n">NODRAW</span><span class="o">;</span>

<span class="n">DRAWTEXT_FIX</span><span class="o">(</span><span class="n">ISLASTBAR</span><span class="o">,</span><span class="w"> </span><span class="mf">0.01</span><span class="o">,</span><span class="w"> </span><span class="mf">0.25</span><span class="o">,</span><span class="w"> </span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="n">STRCAT</span><span class="o">(</span><span class="s1">&#39;流通市值(亿):&#39;</span><span class="o">,</span><span class="w"> </span><span class="n">CON2STR</span><span class="o">(</span><span class="err">流通市值</span><span class="o">,</span><span class="mi">2</span><span class="o">)</span><span class="w"> </span><span class="o">)),</span><span class="w"> </span><span class="n">COLORLICYAN</span><span class="o">;{</span><span class="err">右，下，左</span><span class="o">};</span>



<span class="o">{</span><span class="err">涨跌停</span><span class="n">K线颜色修改</span><span class="err">，股票涨跌停四舍五入有误差，股价太低的涨跌停会存在漏判或错判，尽量忽略，主图叠加</span><span class="o">}</span>

<span class="err">涨停价</span><span class="o">:=</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">4</span><span class="o">,</span><span class="mf">1.198</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">3</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">DATE</span><span class="o">&gt;=</span><span class="mi">1200822</span><span class="o">,</span><span class="mf">1.198</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">3</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">DATE</span><span class="o">&lt;</span><span class="mi">1200822</span><span class="o">,</span><span class="mf">1.099</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">2</span><span class="o">,</span><span class="mf">1.297</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">NAMELIKE</span><span class="o">(</span><span class="s1">&#39;ST&#39;</span><span class="o">)</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">NAMELIKE</span><span class="o">(</span><span class="s1">&#39;*ST&#39;</span><span class="o">),</span><span class="mf">1.0489</span><span class="o">,</span><span class="mf">1.099</span><span class="o">)))))*</span><span class="n">REF</span><span class="o">(</span><span class="n">CLOSE</span><span class="o">,</span><span class="mi">1</span><span class="o">);</span>
<span class="err">跌停价</span><span class="o">:=</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">4</span><span class="o">,</span><span class="mf">0.802</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">3</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">DATE</span><span class="o">&gt;=</span><span class="mi">1200822</span><span class="o">,</span><span class="mf">0.802</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">3</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">DATE</span><span class="o">&lt;</span><span class="mi">1200822</span><span class="o">,</span><span class="mf">0.901</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">FINANCE</span><span class="o">(</span><span class="mi">3</span><span class="o">)=</span><span class="mi">2</span><span class="o">,</span><span class="mf">0.703</span><span class="o">,</span><span class="n">IF</span><span class="o">(</span><span class="n">NAMELIKE</span><span class="o">(</span><span class="s1">&#39;ST&#39;</span><span class="o">)</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">NAMELIKE</span><span class="o">(</span><span class="s1">&#39;*ST&#39;</span><span class="o">),</span><span class="mf">0.9511</span><span class="o">,</span><span class="mf">0.901</span><span class="o">)))))*</span><span class="n">REF</span><span class="o">(</span><span class="n">CLOSE</span><span class="o">,</span><span class="mi">1</span><span class="o">);</span>
<span class="err">涨停</span><span class="o">:=</span><span class="n">CLOSE</span><span class="o">&gt;=</span><span class="err">涨停价</span><span class="o">;</span>
<span class="err">跌停</span><span class="o">:=</span><span class="n">CLOSE</span><span class="o">&lt;=</span><span class="err">跌停价</span><span class="o">;</span>
<span class="n">DRAWKLINE</span><span class="o">(</span><span class="n">HIGH</span><span class="o">,</span><span class="n">OPEN</span><span class="o">,</span><span class="n">LOW</span><span class="o">,</span><span class="n">CLOSE</span><span class="o">);</span>
<span class="n">STICKLINE</span><span class="o">(</span><span class="err">涨停</span><span class="o">,</span><span class="n">HIGH</span><span class="o">,</span><span class="n">LOW</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">),</span><span class="n">COLORYELLOW</span><span class="o">;</span>
<span class="n">STICKLINE</span><span class="o">(</span><span class="err">涨停</span><span class="o">,</span><span class="n">OPEN</span><span class="o">,</span><span class="n">CLOSE</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">1</span><span class="o">),</span><span class="n">COLORYELLOW</span><span class="o">;</span>
<span class="n">STICKLINE</span><span class="o">(</span><span class="err">跌停</span><span class="o">,</span><span class="n">HIGH</span><span class="o">,</span><span class="n">LOW</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">),</span><span class="n">COLORBLUE</span><span class="o">;</span>
<span class="n">STICKLINE</span><span class="o">(</span><span class="err">跌停</span><span class="o">,</span><span class="n">OPEN</span><span class="o">,</span><span class="n">CLOSE</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">0</span><span class="o">),</span><span class="n">COLORBLUE</span><span class="o">;</span>
</code></pre></div>

<h1 id="_2">缩量爆量指标</h1>
<div class="codehilite"><pre><span></span><code>COUNT(AMOUNT&lt;REF(AMOUNT,1)*0.6,1);
COUNT(AMOUNT&gt;REF(AMOUNT,1)*1.4,1);

成交额   
小于前一天的0.6倍
大于前一天的1.4倍
</code></pre></div>

<h1 id="_3">开盘竞价</h1>
<div class="codehilite"><pre><span></span><code><span class="p">{</span><span class="err">开盘价:OPEN</span><span class="p">;}</span>

<span class="p">{</span><span class="err">开盘成交额:GPJYVALUE(25,1,0)*O/100,NODRAW</span><span class="p">;}</span>
<span class="nt">开盘成交额</span><span class="p">:</span><span class="nd">IF</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="nt">DYNAINFO</span><span class="o">(</span><span class="nt">15</span><span class="o">)/</span><span class="nt">10000</span><span class="o">,</span><span class="nt">GPJYVALUE</span><span class="o">(</span><span class="nt">25</span><span class="o">,</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="o">)*</span><span class="nt">O</span><span class="o">/</span><span class="nt">100</span><span class="o">),</span><span class="nt">NODRAW</span><span class="o">;</span>
<span class="nt">STICKLINE</span><span class="o">(</span><span class="nt">O</span><span class="o">&gt;</span><span class="nt">REF</span><span class="o">(</span><span class="nt">C</span><span class="o">,</span><span class="nt">1</span><span class="o">)</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">开盘成交额</span><span class="o">&gt;</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="nt">开盘成交额</span><span class="o">,</span><span class="nt">2</span><span class="o">,</span><span class="nt">2</span><span class="o">),</span><span class="nt">COLORRED</span><span class="o">;</span>
<span class="nt">STICKLINE</span><span class="o">(</span><span class="nt">O</span><span class="o">&lt;</span><span class="nt">REF</span><span class="o">(</span><span class="nt">C</span><span class="o">,</span><span class="nt">1</span><span class="o">)</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">开盘成交额</span><span class="o">&gt;</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="nt">开盘成交额</span><span class="o">,</span><span class="nt">2</span><span class="o">,</span><span class="nt">2</span><span class="o">),</span><span class="nt">COLORGREEN</span><span class="o">;</span>
<span class="nt">STICKLINE</span><span class="o">(</span><span class="nt">O</span><span class="o">=</span><span class="nt">REF</span><span class="o">(</span><span class="nt">C</span><span class="o">,</span><span class="nt">1</span><span class="o">)</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">开盘成交额</span><span class="o">&gt;</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="nt">开盘成交额</span><span class="o">,</span><span class="nt">2</span><span class="o">,</span><span class="nt">2</span><span class="o">),</span><span class="nt">COLORBLUE</span><span class="o">;</span>
<span class="nt">开盘涨幅</span><span class="o">:((</span><span class="nt">OPEN</span><span class="o">/</span><span class="nt">REF</span><span class="o">(</span><span class="nt">C</span><span class="o">,</span><span class="nt">1</span><span class="o">))</span><span class="nt">-1</span><span class="o">)*</span><span class="nt">100</span><span class="o">,</span><span class="nt">COLORLIBLUE</span><span class="o">;</span>


<span class="err">#</span><span class="w"> </span><span class="nt">主力净额</span>

<span class="nt">超B</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>
<span class="nt">大B</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>

<span class="nt">超S</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">1</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>
<span class="nt">大S</span><span class="o">:=</span><span class="nt">L2_AMO</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">1</span><span class="o">)/</span><span class="nt">10000</span><span class="p">.</span><span class="nc">0</span><span class="o">;</span>

<span class="nt">主力净额</span><span class="o">:((</span><span class="nt">超B</span><span class="o">+</span><span class="nt">大B</span><span class="o">)</span><span class="nt">-</span><span class="o">(</span><span class="nt">超S</span><span class="o">+</span><span class="nt">大S</span><span class="o">))/</span><span class="nt">10000</span><span class="o">,</span><span class="nt">NODRAW</span><span class="o">;</span>

<span class="p">{</span><span class="err">显示流通市值</span><span class="p">}</span>
<span class="nt">流通市值</span><span class="p">:</span><span class="nd">ROUND2</span><span class="o">(</span><span class="nt">FINANCE</span><span class="o">(</span><span class="nt">46</span><span class="o">)*</span><span class="nt">DYNAINFO</span><span class="o">(</span><span class="nt">7</span><span class="o">)/</span><span class="nt">100000000</span><span class="o">,</span><span class="nt">2</span><span class="o">),</span><span class="nt">NODRAW</span><span class="o">;</span>

<span class="nt">STICKLINE</span><span class="o">(</span><span class="nt">主力净额</span><span class="o">&gt;</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="nt">主力净额</span><span class="o">,</span><span class="nt">2</span><span class="o">,</span><span class="nt">0</span><span class="o">),</span><span class="nt">COLORRED</span><span class="o">;</span>
<span class="nt">STICKLINE</span><span class="o">(</span><span class="nt">主力净额</span><span class="o">&lt;</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="nt">主力净额</span><span class="o">,</span><span class="nt">2</span><span class="o">,</span><span class="nt">0</span><span class="o">),</span><span class="nt">COLORCYAN</span><span class="o">;</span>
</code></pre></div>

<h1 id="_4">同花顺分时代码，显示股票概念和涨停跌停数量（修改分时）</h1>
<div class="codehilite"><pre><span></span><code><span class="nt">上涨家数</span><span class="o">:=</span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;1A0002&quot;</span><span class="o">,&amp;</span><span class="nt">RISECOUNT</span><span class="o">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;399002&quot;</span><span class="o">,&amp;</span><span class="nt">RISECOUNT</span><span class="o">);</span>
<span class="nt">下跌家数</span><span class="o">:=</span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;1A0002&quot;</span><span class="o">,&amp;</span><span class="nt">FALLCOUNT</span><span class="o">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;399002&quot;</span><span class="o">,&amp;</span><span class="nt">FALLCOUNT</span><span class="o">);</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">6</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">84</span><span class="o">,</span><span class="nt">1</span><span class="o">,</span><span class="s2">&quot;上涨家数：&quot;</span><span class="o">+</span><span class="nt">TOSTRING</span><span class="o">(</span><span class="nt">上涨家数</span><span class="o">,</span><span class="nt">0</span><span class="o">)),</span><span class="nt">colorred</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">84</span><span class="o">,</span><span class="nt">1</span><span class="o">,</span><span class="s2">&quot;下跌家数：&quot;</span><span class="o">+</span><span class="nt">TOSTRING</span><span class="o">(</span><span class="nt">下跌家数</span><span class="o">,</span><span class="nt">0</span><span class="o">)),</span><span class="nt">colorgreen</span><span class="o">;</span>
<span class="nt">涨停</span><span class="o">:=</span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;1A0002&quot;</span><span class="o">,&amp;</span><span class="nt">RISELIMITCOUNT</span><span class="o">)+</span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;399002&quot;</span><span class="o">,&amp;</span><span class="nt">RISELIMITCOUNT</span><span class="o">);</span>
<span class="nt">跌停</span><span class="o">:=</span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;1A0002&quot;</span><span class="o">,&amp;</span><span class="nt">FALLLIMITCOUNT</span><span class="o">)+</span><span class="nt">INDEXDATA</span><span class="o">(</span><span class="s2">&quot;399002&quot;</span><span class="o">,&amp;</span><span class="nt">FALLLIMITCOUNT</span><span class="o">);</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">6</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">92</span><span class="o">,</span><span class="nt">1</span><span class="o">,</span><span class="s2">&quot;涨停：&quot;</span><span class="o">+</span><span class="nt">TOSTRING</span><span class="o">(</span><span class="nt">涨停</span><span class="o">,</span><span class="nt">0</span><span class="o">)),</span><span class="nt">colorlired</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">ISLASTBAR</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">92</span><span class="o">,</span><span class="nt">1</span><span class="o">,</span><span class="s2">&quot;跌停：&quot;</span><span class="o">+</span><span class="nt">TOSTRING</span><span class="o">(</span><span class="nt">跌停</span><span class="o">,</span><span class="nt">0</span><span class="o">)),</span><span class="nt">colorliblue</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">05</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">68</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="s1">&#39;概念：&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">3</span><span class="o">,</span><span class="nt">15</span><span class="o">)),</span><span class="nt">colorcyan</span><span class="o">;</span><span class="w">   </span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">05</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">92</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="s1">&#39;行业：&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">00</span><span class="o">)+</span><span class="s1">&#39;__&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="o">)+</span><span class="s1">&#39;__&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">2</span><span class="o">,</span><span class="nt">0</span><span class="o">)),</span><span class="nt">colormagenta</span><span class="o">;</span><span class="w">   </span>


<span class="nt">NEW1</span><span class="o">:=</span><span class="nt">IF</span><span class="o">(</span><span class="nt">ISNULL</span><span class="o">(</span><span class="nt">NEW</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">)</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">FORMATTIME</span><span class="o">(</span><span class="nt">1</span><span class="o">)&lt;</span><span class="nt">2</span><span class="o">,</span><span class="nt">PRE</span><span class="o">,</span><span class="nt">NEW</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">);</span><span class="w">   </span>
<span class="nt">最新</span><span class="p">:</span><span class="nd">IF</span><span class="o">(</span><span class="nt">ISNULL</span><span class="o">(</span><span class="nt">NEW</span><span class="o">),</span><span class="nt">NEW1</span><span class="o">,</span><span class="nt">NEW</span><span class="o">);</span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">ISNULL</span><span class="o">(</span><span class="nt">RANGE_AVG_PRICE</span><span class="o">)</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">RANGE_AVG_PRICE</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nt">0</span><span class="o">)</span>
<span class="p">{</span><span class="w">  </span>
<span class="w">       </span><span class="err">IF((MARKETTYPE==16</span><span class="w"> </span><span class="err">OR</span><span class="w"> </span><span class="err">MARKETTYPE==32)AND</span><span class="w"> </span><span class="err">CODETYPE==0)</span>
<span class="w">       </span><span class="err">{</span>
<span class="w">              </span><span class="err">领先:(INDEXLEAD/10000</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">1)*PRE</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="nt">ELSE</span><span class="w"> </span><span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">MARKETTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nt">232</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nt">56</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="o">==</span><span class="nt">64</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="o">==</span><span class="nt">128</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nt">80</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="o">==</span><span class="nt">88</span><span class="w"> </span><span class="nt">OR</span><span class="w"> </span><span class="o">(</span><span class="nt">VOL</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nt">1</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">VOL</span><span class="o">&lt;</span><span class="nt">100</span><span class="o">))</span>
<span class="w">       </span><span class="p">{</span>
<span class="w">              </span><span class="err">b=SUBSAMEDAY(&amp;VOL)</span><span class="w"> </span><span class="p">;</span>
<span class="w">              </span><span class="err">m=SUM(b*最新,0)</span><span class="p">;</span>
<span class="w">              </span><span class="err">均价:IF(m&gt;0,m/VOL,PRE)</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="nt">ELSE</span><span class="w"> </span><span class="nt">IF</span><span class="o">(</span><span class="nt">CODETYPE</span><span class="o">!=</span><span class="nt">0</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">MONEY</span><span class="o">&gt;</span><span class="nt">0</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nt">48</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">MARKETTYPE</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nt">104</span><span class="o">)</span>
<span class="w">       </span><span class="p">{</span>
<span class="w">              </span><span class="err">IF(ISNULL(MONEY)</span><span class="w"> </span><span class="err">OR</span><span class="w"> </span><span class="err">ISNULL(VOL)</span><span class="w"> </span><span class="err">OR</span><span class="w"> </span><span class="err">VOL==0</span><span class="w"> </span><span class="err">OR</span><span class="w"> </span><span class="err">MONEY==0)</span>
<span class="w">                     </span><span class="err">均价:IF(ISNULL(均价</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="err">),PRE,均价</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="err">)</span><span class="p">;</span>
<span class="w">              </span><span class="err">ELSE</span><span class="w"> </span><span class="err">IF(VOL==VOL</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="w"> </span><span class="err">OR</span><span class="w"> </span><span class="err">MONEY==MONEY</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="err">)</span>
<span class="w">              </span><span class="err">均价:均价</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="p">;</span>
<span class="w">              </span><span class="err">ELSE</span>
<span class="w">              </span><span class="err">均价:MONEY/VOL</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="nt">ELSE</span><span class="w"> </span><span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">MARKETTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nt">176</span><span class="o">)</span>
<span class="w">       </span><span class="p">{</span>
<span class="w">              </span><span class="err">b=SUBSAMEDAY(&amp;MONEY)</span><span class="p">;</span>
<span class="w">              </span><span class="err">m=SUM(b*最新,0)</span><span class="p">;</span>
<span class="w">              </span><span class="err">IF(m&gt;0)</span>
<span class="w">                     </span><span class="err">均价:m/MONEY</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="err">}</span>
<span class="nt">ELSE</span>
<span class="p">{</span>
<span class="w">       </span><span class="err">均价:RANGE_AVG_PRICE</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">DRAWGBK</span><span class="o">(</span><span class="nt">MARKETTYPE</span><span class="o">==</span><span class="nt">32</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">FORMATTIME</span><span class="o">(</span><span class="nt">1</span><span class="o">)&lt;</span><span class="nt">10</span><span class="w"> </span><span class="nt">AND</span><span class="w"> </span><span class="nt">TRADETIME</span><span class="o">&gt;</span><span class="nt">242</span><span class="o">,</span><span class="nt">RGB</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="nt">128</span><span class="o">));</span><span class="w">   </span>

<span class="nt">RETURN</span><span class="o">;</span>


<span class="nt">hx_star</span><span class="o">;</span>
<span class="nt">hx_star_p</span><span class="o">;</span>
</code></pre></div>

<h1 id="k_1">同花顺k线代码（修改均线）</h1>
<div class="codehilite"><pre><span></span><code><span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">0</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">1</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N1</span><span class="o">);</span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">1</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">2</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N2</span><span class="o">);</span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">2</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">3</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N3</span><span class="o">);</span><span class="w"> </span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">3</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">4</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N4</span><span class="o">);</span><span class="w"> </span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">4</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">5</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N5</span><span class="o">);</span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">5</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">6</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N6</span><span class="o">);</span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">6</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">7</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N7</span><span class="o">);</span>
<span class="nt">IF</span><span class="w"> </span><span class="o">(</span><span class="nt">k</span><span class="o">&gt;</span><span class="nt">7</span><span class="o">)</span>
<span class="nt">MA</span><span class="o">$</span><span class="nt">8</span><span class="p">:</span><span class="nd">MA</span><span class="o">(</span><span class="nt">CLOSE</span><span class="o">,</span><span class="w"> </span><span class="nt">N8</span><span class="o">);</span>

<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">03</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">03</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="s1">&#39;地域:&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">2</span><span class="o">,</span><span class="nt">0</span><span class="o">)),</span><span class="nt">colorgreen</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">1</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">03</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="s1">&#39;行业:&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">0</span><span class="o">,</span><span class="nt">0</span><span class="o">)+</span><span class="s1">&#39;*/*&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">10</span><span class="o">)),</span><span class="nt">colorgreen</span><span class="o">;</span>
<span class="nt">DRAWTEXT_FIX</span><span class="o">(</span><span class="nt">1</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">25</span><span class="o">,</span><span class="nt">0</span><span class="p">.</span><span class="nc">03</span><span class="o">,</span><span class="nt">0</span><span class="o">,</span><span class="s1">&#39;概念:&#39;</span><span class="o">+</span><span class="nt">BLOCK</span><span class="o">(</span><span class="nt">3</span><span class="o">,</span><span class="nt">25</span><span class="o">)),</span><span class="nt">colorgreen</span><span class="o">;</span>
</code></pre></div>
        <!-- 图片放大功能样式 -->
        <style>
            /* 图片容器：居中显示，添加间距 */
            .img-zoom-container {
                text-align: center;
                margin: 1.5rem 0;
            }

            /* 可点击放大的图片样式 */
            .zoomable-img {
                max-width: 100%;
                height: auto;
                cursor: zoom-in; /* 鼠标悬停显示放大镜图标 */
                border-radius: 4px;
                transition: transform 0.2s ease;
            }

            .zoomable-img:hover {
                transform: scale(1.01); /* 轻微放大效果，提示可点击 */
            }

            /* 放大后的遮罩层（全屏显示） */
            .image-modal {
                display: none; /* 默认隐藏 */
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.9); /* 半透明黑色背景 */
                z-index: 9999; /* 确保在最上层 */
                align-items: center;
                justify-content: center;
                padding: 20px;
                overflow: hidden;
            }

            /* 放大后的图片容器（用于拖拽） */
            .modal-image-wrapper {
                position: relative;
                cursor: grab;
            }

            .modal-image-wrapper.grabbing {
                cursor: grabbing;
            }

            /* 放大后的图片 */
            .modal-content {
                max-width: 95%; /* 最大宽度不超过屏幕95% */
                max-height: 90%; /* 最大高度不超过屏幕90% */
                transition: transform 0.1s ease;
                transform-origin: center;
            }

            /* 关闭按钮 */
            .close-modal {
                position: absolute;
                top: 20px;
                right: 30px;
                color: white;
                font-size: 36px;
                font-weight: bold;
                cursor: pointer;
                transition: color 0.2s;
                z-index: 10000;
            }

            .close-modal:hover {
                color: #ccc; /* 鼠标悬停变灰 */
            }

            /* 缩放提示 */
            .zoom-hint {
                position: absolute;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                color: white;
                background: rgba(0,0,0,0.5);
                padding: 5px 10px;
                border-radius: 4px;
                font-size: 0.9rem;
            }
        </style>

        <!-- 图片放大功能脚本（带滚轮缩放） -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // 创建遮罩层元素
                const modal = document.createElement('div');
                modal.className = 'image-modal';
                modal.innerHTML = `
                    <span class="close-modal">&times;</span>
                    <div class="zoom-hint">鼠标滚轮缩放 | 拖动移动 | ESC关闭</div>
                    <div class="modal-image-wrapper">
                        <img class="modal-content" src="" alt="放大后的图片">
                    </div>
                `;
                document.body.appendChild(modal);

                // 获取元素引用
                const modalImg = modal.querySelector('.modal-content');
                const closeBtn = modal.querySelector('.close-modal');
                const imgWrapper = modal.querySelector('.modal-image-wrapper');
                const modalContainer = modal;

                // 缩放和位置变量
                let scale = 1;          // 缩放比例
                let translateX = 0;     // X轴偏移
                let translateY = 0;     // Y轴偏移
                let lastX = 0;          // 上次鼠标X位置
                let lastY = 0;          // 上次鼠标Y位置
                let isDragging = false; // 是否正在拖拽

                // 重置图片状态
                function resetImageState() {
                    scale = 1;
                    translateX = 0;
                    translateY = 0;
                    updateImageTransform();
                }

                // 更新图片变换
                function updateImageTransform() {
                    modalImg.style.transform = `scale(${scale}) translate(${translateX}px, ${translateY}px)`;
                }

                // 点击图片放大
                document.querySelectorAll('.zoomable-img').forEach(img => {
                    img.addEventListener('click', function() {
                        modalContainer.style.display = 'flex';
                        modalImg.src = this.src;
                        resetImageState(); // 每次打开重置状态
                    });
                });

                // 关闭放大视图
                function closeModal() {
                    modalContainer.style.display = 'none';
                    resetImageState();
                }

                // 点击关闭按钮关闭
                closeBtn.addEventListener('click', closeModal);

                // 点击遮罩层空白处关闭
                modalContainer.addEventListener('click', function(e) {
                    if (e.target === modalContainer) {
                        closeModal();
                    }
                });

                // 按ESC键关闭
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' && modalContainer.style.display === 'flex') {
                        closeModal();
                    }
                });

                // 鼠标滚轮缩放
                imgWrapper.addEventListener('wheel', function(e) {
                    e.preventDefault(); // 阻止页面滚动

                    // 获取鼠标在图片上的位置（相对于图片中心）
                    const rect = modalImg.getBoundingClientRect();
                    const mouseX = e.clientX - rect.left - rect.width / 2;
                    const mouseY = e.clientY - rect.top - rect.height / 2;

                    // 根据滚轮方向调整缩放比例
                    const delta = e.deltaY < 0 ? 0.1 : -0.1;
                    const newScale = Math.max(0.5, Math.min(scale + delta, 5)); // 限制缩放范围0.5-5倍

                    // 计算缩放时的位置偏移，使鼠标指向的点保持在原位
                    translateX = mouseX * (scale - newScale) / scale + translateX;
                    translateY = mouseY * (scale - newScale) / scale + translateY;

                    scale = newScale;
                    updateImageTransform();
                });

                // 鼠标按下开始拖拽
                imgWrapper.addEventListener('mousedown', function(e) {
                    e.preventDefault();
                    isDragging = true;
                    lastX = e.clientX;
                    lastY = e.clientY;
                    imgWrapper.classList.add('grabbing');
                });

                // 鼠标移动时拖拽
                document.addEventListener('mousemove', function(e) {
                    if (!isDragging) return;
                    
                    // 计算移动距离
                    const deltaX = e.clientX - lastX;
                    const deltaY = e.clientY - lastY;
                    
                    // 更新位置
                    translateX += deltaX;
                    translateY += deltaY;
                    
                    // 保存当前位置
                    lastX = e.clientX;
                    lastY = e.clientY;
                    
                    updateImageTransform();
                });

                // 鼠标释放结束拖拽
                document.addEventListener('mouseup', function() {
                    isDragging = false;
                    imgWrapper.classList.remove('grabbing');
                });

                // 鼠标离开窗口结束拖拽
                document.addEventListener('mouseleave', function() {
                    isDragging = false;
                    imgWrapper.classList.remove('grabbing');
                });
            });
        </script>
        
    </div>

    <!-- 文章导航 -->
    <nav class="post-navigation">
        
        
    </nav>
</article>

    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="footer-content" style="text-align: center;">
            <p>&copy; <span id="current-year"></span> 版权所有</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="static/js/main.js"></script>
    <script src="static/js/prism.js"></script>
    <script>
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>
</body>
</html>